<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Biproportional apportionment — biproportional • proporz</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Biproportional apportionment — biproportional" />
<meta property="og:description" content="Method to proportionally allocate seatsamong parties (or lists) and
districts (or entities, regions)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">proporz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Biproportional apportionment</h1>
    
    <div class="hidden name"><code>biproportional.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Method to proportionally allocate seatsamong parties (or lists) and
districts (or entities, regions).</p>
    </div>

    <pre class="usage"><span class='fu'>biproportional</span><span class='op'>(</span>
  <span class='va'>votes_matrix</span>,
  <span class='va'>district_seats</span>,
  quorum_districts <span class='op'>=</span> <span class='fl'>0</span>,
  quorum_total <span class='op'>=</span> <span class='fl'>0</span>,
  use_list_votes <span class='op'>=</span> <span class='cn'>TRUE</span>,
  method <span class='op'>=</span> <span class='st'>"round"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>votes_matrix</th>
      <td><p>Vote count matrix with votes by party in rows
and votes by district in columns</p></td>
    </tr>
    <tr>
      <th>district_seats</th>
      <td><p>Vector defining the number of seats per district.
Must be the same length as ncol(votes_matrix). If the number
of seats per district should be assigned according to the
number of votes (not the general use case), a single
number for the total number of seats can be used.</p></td>
    </tr>
    <tr>
      <th>quorum_districts</th>
      <td><p>Vote threshold a party must reach in <em>at least</em> one
district. Used as quota of total votes within a
district if less than 1 otherwise as number of votes.</p></td>
    </tr>
    <tr>
      <th>quorum_total</th>
      <td><p>Vote threshold a party must reach for all votes cast.
Used as quota of total votes if less than 1 otherwise
as number of votes.</p></td>
    </tr>
    <tr>
      <th>use_list_votes</th>
      <td><p>By default (TRUE) it's assumed that each voter in a district has as
many votes as there are seats in a district. Set to FALSE if
<code>votes_matrix</code> shows the number of voters.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Defines how seats in upper and lower apportionment are assigned. The
default "round" for the Sainte-Lague/Webster method is the standard
for biproportional apportionment. See <a href='proporz.html'>proporz</a> for a list of
available methods. For a different method for upper and lower apportionment
use a vector with two entries. It is also possible to provide a function
that works like base::round(x) (i.e. can handle a matrix).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Each party nominates a candidate list for every district. The voters vote for the
parties of their district. The seat allocation is calculated in two steps:</p><ol>
<li><p>In the so called <em>upper apportionment</em> the number of seats for each party
   (over all districts) is determined. Normally, the number of seats for each region
   are defined before the election and are independent of the vote counts.</p></li>
<li><p>In the so called <em>lower apportionment</em> the seats are distributed to the
   regional party list respecting the results from the upper apportionment.</p></li>
</ol>

<p>Parties failing to reach at least one quorum cannot get seats.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The iterative process in the lower apportionment is only guaranteed to terminate
      with Sainte-Laguë/Webster method.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='pukelsheim.html'>pukelsheim</a> for usage with data frames.
         <code><a href='divisors.html'>divisors</a></code> to access the divisors</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>votes_df</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>zug2018</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"list_id"</span>, <span class='st'>"entity_id"</span>, <span class='st'>"list_votes"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>votes_matrix</span> <span class='op'>=</span> <span class='fu'><a href='pivot_to_matrix.html'>pivot_to_matrix</a></span><span class='op'>(</span><span class='va'>votes_df</span><span class='op'>)</span>
<span class='va'>votes_matrix</span>
</div><div class='output co'>#&gt;        entity_id
#&gt; list_id  1701 1702 1703 1704 1705 1706 1707 1708 1709 1710  1711
#&gt;       1  2993    0    0    0    0    0    0    0    0    0     0
#&gt;       2  8108 4687 1584  531  279  477 2363 3860 1481   91 22023
#&gt;       3 19389 9334 4807 1946  396 2844 3523 4702 3310  812 21343
#&gt;       4 14814 6691 4005  826  379 1654 2842 2624 2713  461 33789
#&gt;       5  4486 2270  621  198    0  361  728  465  925    0 10131
#&gt;       6 15695 4705 1750   84    0   51  627 1106 1563  302 21794
#&gt;       7 21298 8178 2875 1336  399 1450 3715 2610 4063  344 26798</div><div class='input'><span class='co'>#&gt;        entity_id</span>
<span class='co'>#&gt; list_id  1701 1702 1703 1704 1705 1706 1707 1708 1709 1710  1711</span>
<span class='co'>#&gt;       1  2993    0    0    0    0    0    0    0    0    0     0</span>
<span class='co'>#&gt;       2  8108 4687 1584  531  279  477 2363 3860 1481   91 22023</span>
<span class='co'>#&gt;       3 19389 9334 4807 1946  396 2844 3523 4702 3310  812 21343</span>
<span class='co'>#&gt;       4 14814 6691 4005  826  379 1654 2842 2624 2713  461 33789</span>
<span class='co'>#&gt;       5  4486 2270  621  198    0  361  728  465  925    0 10131</span>
<span class='co'>#&gt;       6 15695 4705 1750   84    0   51  627 1106 1563  302 21794</span>
<span class='co'>#&gt;       7 21298 8178 2875 1336  399 1450 3715 2610 4063  344 26798</span>

<span class='va'>distr_df</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>zug2018</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"entity_id"</span>, <span class='st'>"election_mandates"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>district_seats</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span><span class='va'>distr_df</span><span class='op'>$</span><span class='va'>election_mandates</span>, <span class='va'>distr_df</span><span class='op'>$</span><span class='va'>entity_id</span><span class='op'>)</span>
<span class='va'>district_seats</span>
</div><div class='output co'>#&gt; 1701 1702 1703 1704 1705 1706 1707 1708 1709 1710 1711 
#&gt;   15   10    6    3    2    4    7    6    6    2   19 </div><div class='input'><span class='co'>#&gt; 1701 1702 1703 1704 1705 1706 1707 1708 1709 1710 1711</span>
<span class='co'>#&gt;   15   10    6    3    2    4    7    6    6    2   19</span>

<span class='fu'>biproportional</span><span class='op'>(</span><span class='va'>votes_matrix</span>, <span class='va'>district_seats</span>, <span class='fl'>0.05</span>, <span class='fl'>0.03</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        entity_id
#&gt; list_id 1701 1702 1703 1704 1705 1706 1707 1708 1709 1710 1711
#&gt;       1    0    0    0    0    0    0    0    0    0    0    0
#&gt;       2    2    1    1    0    0    0    1    2    1    0    3
#&gt;       3    3    3    2    1    1    2    2    2    1    1    3
#&gt;       4    2    2    1    1    0    1    2    1    1    1    5
#&gt;       5    1    1    0    0    0    0    0    0    0    0    2
#&gt;       6    3    1    1    0    0    0    0    0    1    0    3
#&gt;       7    4    2    1    1    1    1    2    1    2    0    3
#&gt; attr(,"divisors")
#&gt; attr(,"divisors")$districts
#&gt;      1701      1702      1703      1704      1705      1706      1707      1708 
#&gt; 5745.5376 3586.0000 2607.0000 1435.0000  743.0312 1709.0000 1816.8750 2561.0000 
#&gt;      1709      1710      1711 
#&gt; 2342.0000  725.5000 7275.1719 
#&gt; 
#&gt; attr(,"divisors")$parties
#&gt;         1         2         3         4         5         6         7 
#&gt; 1.0000000 0.8828125 1.0000000 1.0316329 0.8750000 1.0000000 1.0537109 
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "proporz_matrix" "matrix"         "array"         </div><div class='input'><span class='co'>#&gt;         entity_id</span>
<span class='co'>#&gt; list_id 1701 1702 1703 1704 1705 1706 1707 1708 1709 1710 1711</span>
<span class='co'>#&gt;       1    0    0    0    0    0    0    0    0    0    0    0</span>
<span class='co'>#&gt;       2    2    1    1    0    0    0    1    2    1    0    3</span>
<span class='co'>#&gt;       3    3    3    2    1    1    2    2    2    1    1    3</span>
<span class='co'>#&gt;       4    2    2    1    1    0    1    2    1    1    1    5</span>
<span class='co'>#&gt;       5    1    1    0    0    0    0    0    0    0    0    2</span>
<span class='co'>#&gt;       6    3    1    1    0    0    0    0    0    1    0    3</span>
<span class='co'>#&gt;       7    4    2    1    1    1    1    2    1    2    0    3</span>

<span class='co'># Different method for upper apportionment</span>
<span class='co'># and using number of voters instead of list votes</span>
<span class='va'>f19_matrix</span> <span class='op'>=</span> <span class='fu'><a href='pivot_to_matrix.html'>pivot_to_matrix</a></span><span class='op'>(</span><span class='va'>finland2019</span><span class='op'>$</span><span class='va'>votes_df</span><span class='op'>)</span>
<span class='va'>f19_distr_seats</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span>
    <span class='va'>finland2019</span><span class='op'>$</span><span class='va'>district_seats_df</span><span class='op'>$</span><span class='va'>election_mandates</span>,
    <span class='va'>finland2019</span><span class='op'>$</span><span class='va'>district_seats_df</span><span class='op'>$</span><span class='va'>entity_id</span><span class='op'>)</span>

<span class='fu'>biproportional</span><span class='op'>(</span><span class='va'>f19_matrix</span>, <span class='va'>f19_distr_seats</span>,
               use_list_votes <span class='op'>=</span> <span class='cn'>FALSE</span>,
               method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"floor"</span>, <span class='st'>"round"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         entity_id
#&gt; list_id  HAEM HEL KAA KES LAP OUL PIR SAT SKA UUS VAA VAR
#&gt;   Asyl      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   E117      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   E118      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   E154      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   E168      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   E169      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   E185      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   E191      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   E192      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   E287      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   E491      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   E492      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   E493      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   EOP       0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   FP        0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   IP        0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   KD        1   0   1   1   0   1   1   0   1   1   1   0
#&gt;   KESK      1   1   3   2   2   6   2   1   3   2   3   2
#&gt;   KOK       3   5   3   1   1   2   4   1   2   7   2   4
#&gt;   KP        0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   KTP       0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   LIBE      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   LII       0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   LIIK      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   LN        0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   LNLY      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   LNY       0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   LNYL      0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   Nyt       0   0   0   0   0   0   0   0   0   1   0   0
#&gt;   NYT       0   1   0   0   0   0   0   0   0   0   0   0
#&gt;   PEL       0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   PIR       0   1   0   0   0   0   0   0   0   0   0   0
#&gt;   PS        3   3   3   2   1   4   3   2   3   6   3   3
#&gt;   REF       0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   Reform    0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   RKP       0   1   0   0   0   0   0   0   0   4   3   1
#&gt;   RLI       0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   SDP       4   3   4   2   1   2   4   2   3   7   2   3
#&gt;   SIN       0   0   0   0   0   0   0   0   1   1   0   0
#&gt;   SKE       0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   SKP       0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   STL       0   0   0   0   0   0   0   0   0   0   0   0
#&gt;   VAS       1   2   1   1   1   2   2   1   1   2   1   2
#&gt;   VIHR      1   5   2   1   1   1   3   1   1   5   1   2
#&gt; attr(,"divisors")
#&gt; attr(,"divisors")$districts
#&gt;     HAEM      HEL      KAA      KES      LAP      OUL      PIR      SAT 
#&gt; 14001.88 18399.13 14410.00 15438.00 14258.00 14105.17 15126.41 14019.00 
#&gt;      SKA      UUS      VAA      VAR 
#&gt; 14596.33 15343.18 16505.43 14892.57 
#&gt; 
#&gt; attr(,"divisors")$parties
#&gt;      Asyl      E117      E118      E154      E168      E169      E185      E191 
#&gt; 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 
#&gt;      E192      E287      E491      E492      E493       EOP        FP        IP 
#&gt; 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 
#&gt;        KD      KESK       KOK        KP       KTP      LIBE       LII      LIIK 
#&gt; 0.8117065 1.0078125 0.9946907 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 
#&gt;        LN      LNLY       LNY      LNYL       Nyt       NYT       PEL       PIR 
#&gt; 1.0000000 1.0000000 1.0000000 1.0000000 1.2500000 1.0000000 1.0000000 0.6250000 
#&gt;        PS       REF    Reform       RKP       RLI       SDP       SIN       SKE 
#&gt; 1.0156250 1.0000000 1.0000000 0.9163910 1.0000000 0.9725345 0.5625000 1.0000000 
#&gt;       SKP       STL       VAS      VIHR 
#&gt; 1.0000000 1.0000000 1.0000000 0.9773330 
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "proporz_matrix" "matrix"         "array"         </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Flavio Poletti.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


